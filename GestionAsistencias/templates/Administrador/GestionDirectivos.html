{% extends "Administrador/BaseAdministrador.html" %}

{% load static %}

{% block content %}

<h2>Directivos</h2>    
<div>
    <table>
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Apellidos</th>
                <th>Matrícula</th>
                <th>Eliminar</th>
                <th>Actualizar</th>
            </tr>
        </thead>
        <tbody>
            {% for directivo in directivos %}
                <tr>
                    <td>{{ directivo.Nombre }}</td>
                    <td>{{ directivo.Apellidos }}</td>
                    <td>{{ directivo.Matricula }}</td>
                    <td>
                        <a href="{% url 'EliminarDirectivo' directivo.idDirectivos %}" onclick="return confirm('¿Estás seguro de que deseas eliminar a este profesor?')">Eliminar</a>
                    </td>
                    <td>
                        <button onclick="openModal({{ directivo.idDirectivos }}, '{{ directivo.Nombre }}', '{{ directivo.Apellidos }}', '{{ directivo.Matricula }}', '{{ directivo.Contrasena }}', '{{ directivo.Correo }}')">Actualizar</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div>
    <button onclick = "abrirCrear()">Ingresar Directivo</button>
</div>

<!-- Modal para editar directivo -->
<div id="editModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>Editar Directivo</h2>
        
        <!-- Formulario de edición -->
        <form method="POST" action="{% url 'EditarDirectivo' 0 %}" id="editForm" onsubmit="return validateMatricula()">
            {% csrf_token %}
            
            <div>
                <label for="id_nombre">Nombre:</label>
                <input type="text" name="nombre" id="id_nombre" required>
            </div>
            
            <div>
                <label for="id_apellido">Apellido:</label>
                <input type="text" name="apellido" id="id_apellido" required>
            </div>

            <div>
                <label for="id_matricula">Matrícula:</label>
                <input type="text" name="matricula" id="id_matricula" required>
            </div>

            <div>
                <label for="id_Contrasena">Contraseña:</label>
                <input type="text" name="Contrasena" id="id_Contrasena" required>
            </div>

            <div>
                <label for="id_Correo">Correo:</label>
                <input type="email" name="Correo" id="id_Correo" required>
            </div>

            <div>
                <button type="submit">Guardar cambios</button>
            </div>
        </form>
    </div>
</div>

<div div id="CrearModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="CerrarModalCrear()">&times;</span>
        <h2>Crear Directivo</h2>
        <form method="POST" action="{% url 'CrearDirectivo' %}">
            {% csrf_token %}
            

            <div>
                <label for="nombre">Nombre:</label>
                {{ form.Nombre }}
            </div>

            <div>
                <label for="apellidos">Apellido:</label>
                {{ form.Apellidos }}
            </div>

            <div>
                <label for="matricula">Matrícula:</label>
                {{ form.Matricula }}
                <!-- Para mostrar el error específico de matrícula -->
                {{ form.Matricula.errors }}
            </div>

            <div>
                <label for="contrasena">Contraseña:</label>
                {{ form.Contrasena }}
            </div>

            <div>
                <label for="correo">Correo:</label>
                {{ form.Correo }}
            </div>

            <div>
                <button type="submit">Crear Directivo</button>
            </div>
        </form>
    </div>
</div>

<script>
    const existingMatriculas = [
        {% for directivo in directivos %}
            '{{ directivo.Matricula }}',
        {% endfor %}
        {% for admin in administradores %}
            '{{ admin.Matricula }}',
        {% endfor %}
        {% for profesor in profesores %}
            '{{ profesor.Matricula }}',
        {% endfor %}
    ];
</script>


{% block extra_css %}
    <link rel="stylesheet" href="{% static 'MenuAdministrador/Styles/GestionDirectivos.css' %}">
{% endblock %}


{% endblock %}

{% block extra_js %}
    <script src="{% static 'MenuAdministrador/Scripts/GestionDirectivos.js' %}"></script> 
{% endblock %}

